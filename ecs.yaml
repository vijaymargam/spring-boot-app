---
  - name: create ecs and task definition
    hosts: ansible-server
    connection: local
    gather_facts: False
    tasks:
    - name: Create task definition
      ecs_taskdefinition:
        family: springboot
        containers:
        - name: springBootApplication
          essential: true
          image: "358537675364.dkr.ecr.ap-south-1.amazonaws.com/springbootapplcation:latest"
          portMappings:
          - containerPort: 8080
            hostPort: 8080
          region: ap-south-1
          cpu: 512
          memory: 1024
        state: present
    - name: create task for cluster
      ecs_task:
        operation: run
        cluster: springBootCluster
        task_definition: springboot
        count: 1
        started_by: ansible_user
      register: task_output
